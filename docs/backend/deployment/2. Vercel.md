
## Overview

The Student Study Planner System is deployed on Vercel to take advantage of its native Next.js integration. We utilize Vercel's infrastructure for DDoS protection, global content delivery, and automated CI/CD workflows linked directly to our GitHub repository.

**Deployment URL:** `https://studyplannersystem-group-3-0bcf2cc8.vercel.app/`

---

## Justifications

### Performance Improvements

- **Edge Network**: Vercel handles static asset caching and API response caching automatically.
    
- **Build Pipeline**: Native support for Next.js incremental static regeneration ensures efficient build times.
    

### Security Posture

- **SSL/TLS**: Certificates are automatically provisioned and renewed.
    
- **Environment Security**: Variables are encrypted at rest and during transit.
    
- **Infrastructure Protection**: Built-in mitigation for common DDoS attack vectors.
    
- **Preview Safety**: Staging deployments are isolated and password-protected (if configured).
    

### Developer Experience

- **Zero-Config Next.js**: No manual server configuration required for Next.js 15+ features.
    
- **Preview Deployments**: Pull requests trigger isolated environments for testing before merge.
    
- **Analytics**: Integrated tracking for Core Web Vitals and real-time performance.
    
- **Rollbacks**: Instant reversion to previous stable builds if a production bug is found.
    

### Security Implementation Details

The application's internal security integrates with the hosting environment:

- **Authentication**: JWT Session Management using `SESSION_SECRET`.
    
- **RBAC**: 5-tier permission system (Viewer to Superadmin).
    
- **Rate Limiting**: Implemented via `rate-limiter-flexible` (5-50 requests/hour depending on role).
    
- **Sanitization**: Input validation and payload size limits on all API routes.
    
- **Audit Logging**: Captures IP and User-Agent data for all critical actions.
    

---

## Deployment Flow

![[git flow.png]]
---

## Environment Configuration

### Required Variables

These are configured in **Vercel Dashboard** > **Project Settings** > **Environment Variables**.

Bash

```
# Server Configuration
NEXT_PUBLIC_SERVER_URL=https://[your-project].vercel.app
NEXT_PUBLIC_MODE=PROD

# Database Configuration (Supabase Pro)
DATABASE_URL=postgres://postgres.[project-ref]:[password]@aws-0-ap-southeast-1.pooler.supabase.com:6543/postgres?pgbouncer=true
DIRECT_URL=postgres://postgres.[project-ref]:[password]@aws-0-ap-southeast-1.pooler.supabase.com:5432/postgres

# Azure AD Authentication
NEXT_PUBLIC_CLIENT_ID=[azure-client-id]
NEXT_PUBLIC_AUTHORITY=https://login.microsoftonline.com/[tenant-id]
NEXT_PUBLIC_REDIRECTURI=https://[your-project].vercel.app/view/dashboard
NEXT_PUBLIC_POSTLOGOUTREDIRECTURI=https://[your-project].vercel.app

# Email Service (Nodemailer)
GMAIL_EMAIL=[your-gmail]
GMAIL_APP_PW=[16-char-app-password]

# Security
SESSION_SECRET=[32-random-characters]

# Access Control
DEFAULT_USER_GROUP_ID=1
DEFAULT_USER_ROLE=Viewer
WHITELIST_MODE=false

# Optional Supabase
NEXT_PUBLIC_DB_URL=https://[project-ref].supabase.co
NEXT_PUBLIC_ANON_KEY=[supabase-anon-key]
NEXT_PUBLIC_SUPABASE_STORAGE_NAME=students-study-planners
```

### Environment Scope

Ensure variables are targeted for the **Production** environment. Preview deployments will inherit these by default unless specific Preview overrides are set.

---

## Deployment Workflow

### Initial Setup

1. Fork & Connect
    
    Fork the main repository to your personal/organization GitHub account.
    
2. **Import to Vercel**
    
    - Go to the [Vercel Dashboard](https://vercel.com/dashboard).
        
    - Select **Add New** > **Project**.
        
    - Import the forked repository.
        
    - Framework Preset: **Next.js** (Should detect automatically).
        
3. **Build Settings**
    
    - **Build Command**: `npm install && npm run build`
        
    - **Output Directory**: `.next`
        
    - **Install Command**: `npm install`
        
    - **Node Version**: 18.x or higher
        
4. Configuration
    
    Copy the variables listed above into the Environment Variables section.
    

### Database Migrations

**Important**: Prisma migrations must be run manually or via a separate CI job before the application code updates. Vercel does not run migrations automatically during the build phase to prevent data loss.

Bash

```
# Run migrations on Supabase Pro
npx prisma migrate deploy

# Alternative (Development only)
npx prisma db push

# Push code to trigger Vercel deployment
git push origin main
```

**Recommendation**: Always verify migrations on a staging copy of the database before applying to production.

---

## Key Features Utilized

### 1. Preview Deployments

Every push creates a unique URL: `https://[project]-[git-hash].vercel.app`. This is used for peer review and QA testing before merging into the main branch.

### 2. Vercel Analytics

Accessed via the **Analytics** tab. We use this to monitor:

- **Core Web Vitals**: LCP, FID, and CLS scores.
    
- **Bottlenecks**: Identification of slow API routes or heavy pages.
    
- **User Geography**: Traffic distribution maps.
    

### 3. Automatic HTTPS

Vercel provisions SSL certificates for all domains and subdomains automatically. It also enforces HTTP-to-HTTPS redirection.

### 4. Edge Caching

Static assets are cached across Vercel's global edge network. Cache invalidation happens automatically when a new deployment is successfully promoted.

---

## Troubleshooting

### Build Failures

Issue: Prisma Client not generated

Solution: Ensure the postinstall or prebuild script is configured in package.json.

JSON

```
"scripts": {
  "postinstall": "prisma generate",
  "build": "next build"
}
```

Issue: Missing Environment Variables

Solution: Check the variable scope in the dashboard. Variables set to "Development" will not appear in "Production" builds.

### Runtime Errors

Issue: Database Connection Failures

Solution: Verify you are using the Transaction Pooler port (6543) and not the Session port (5432) for the DATABASE_URL. Ensure ?pgbouncer=true is appended to the connection string.

Issue: Auth Redirect Failures

Solution: The Azure App Registration must have the production URL whitelisted. Add https://[your-project].vercel.app/view/dashboard to the Redirect URIs in Azure Portal.

### Performance

Issue: Slow API Responses

Solution: Check Supabase query performance. If the query is complex, verify that database indexing is applied correctly.

---

## Deployment Checklist

Before promoting to production:

- [ ] Environment variables configured in Vercel Dashboard
    
- [ ] Database migrations applied to Supabase
    
- [ ] Azure AD redirect URIs updated with production URL
    
- [ ] Functionality verified on Preview Deployment
    
- [ ] Rate limiting confirmed active
    
- [ ] Auth flow (Login/Logout) tested
    
- [ ] SMTP email service tested
    
- [ ] Audit logging verified
    
- [ ] Analytics enabled
    

---
