### 3.1 Role Hierarchy

```directory
src/
└── utils/
    └── permissions.js
```

**Permission Constants Example** (`src/utils/permissions.js`):

```javascript
export const PERMISSIONS = {
    COURSE: {
        CREATE: 'course:create',
        READ: 'course:read',
        UPDATE: 'course:update',
        DELETE: 'course:delete',
        MANAGE: 'course:manage'
    },
    STUDENT: {
        CREATE: 'student:create',
        READ: 'student:read',
        UPDATE: 'student:update',
        DELETE: 'student:delete',
        MANAGE: 'student:manage'
    },
    ROLE: {
        CREATE: 'role:create',
        READ: 'role:read',
        UPDATE: 'role:update',
        DELETE: 'role:delete',
        MANAGE: 'role:manage',
        ASSIGN: 'role:assign'
    },
    USER: {
        CREATE: 'user:create',
        READ: 'user:read',
        UPDATE: 'user:update',
        DELETE: 'user:delete',
        MANAGE: 'user:manage',
        ASSIGN_ROLES: 'user:assign_roles'
    }
};
```

**Available Roles** (by priority):

|**Role**|**Priority**|**Description**|
|---|---|---|
|Superadmin|255|System administrator, all permissions|
|Administrator|200|Administrative functions, most permissions|
|Course Coordinator|100|Course management, limited admin features|
|Viewer|50|Read-only access to assigned resources|
|Student|10|Student-specific features and data|

### 3.2 Permission Model

**Structure**: `resource:action`

**Resources**:

- `course` - Course management
    
- `student` - Student records
    
- `unit` - Unit/subject management
    
- `role` - Role management
    
- `user` - User management
    
- `system` - System configuration
    

**Actions**:

- `CREATE` - Create new resources
    
- `READ` - View resources
    
- `UPDATE` - Modify resources
    
- `DELETE` - Remove resources
    
- `MANAGE` - Administrative control
    

**Examples**:

- `course:read` - View courses
    
- `role:manage` - Manage roles and permissions
    
- `user:*` - All actions on users
    
- `*:manage` - Manage all resources
    
- `*:*` - All actions on all resources
    

### 3.3 PermissionChecker Class

```directory
src/
└── utils/
    └── permissions.js
```

**Permission Check Examples**:

```javascript
import { PermissionChecker, PERMISSIONS } from '@utils/permissions';

// Check single permission
const canCreateCourse = await PermissionChecker.hasPermission(
    userProfileID,
    'course',
    'create'
);

// Check if user has any of multiple permissions (OR logic)
const canManageCourse = await PermissionChecker.hasAnyPermission(
    userProfileID,
    ['course:create', 'course:manage']
);

// Check if user has all permissions (AND logic)
const canFullyManage = await PermissionChecker.hasAllPermissions(
    userProfileID,
    ['course:create', 'course:update', 'course:delete']
);

// Get all user permissions
const permissions = await PermissionChecker.getUserPermissions(userProfileID);
// Returns: ['course:create', 'student:read', 'role:manage', ...]

// Check if user has specific role
const isAdmin = await PermissionChecker.hasRole(userProfileID, 'Administrator');
```

**Client-Side Permission Checking** (Less secure, use for UI only):

```javascript
import { clientPermissions } from '@utils/permissions';

// Check permission on client side (frontend)
const canCreate = clientPermissions.hasPermission(
    userPermissions, // from sessionStorage
    'course',
    'create'
);

// Use for conditional rendering
{canCreate && <button>Create Course</button>}
```

**Methods**:

- `hasPermission(userProfileID, resource, action)` - Single permission check

- `hasAnyPermission(userProfileID, permissions)` - Multiple permissions (OR logic)

- `hasAllPermissions(userProfileID, permissions)` - Multiple permissions (AND logic)

- `getUserPermissions(userProfileID)` - Get all permissions for a user

- `hasRole(userProfileID, roleName)` - Check if user has specific role

- `getUserRoles(userProfileID)` - Get all roles for a user

### 3.4 Superadmin Guard

```directory
src/
└── app/
    └── class/
        └── Role/
            └── SuperadminGuard.js
```

**Purpose**: Prevent system lockout

**Protection Mechanisms**:

- ❌ Cannot deactivate last active Superadmin
    
- ❌ Cannot delete last Superadmin
    
- ❌ Cannot remove all Superadmins from system
    
- ✔ At least one active Superadmin must exist
    

### 3.5 Role Inheritance

- Roles inherit permissions from lower-priority roles
    
- Higher priority roles have superset of lower roles' permissions
    
- Permission expiration supported (ExpiresAt field)
    

### 3.6 Authorization Checks

**Server-Side Enforcement**:

- All API endpoints verify user permissions
    
- User email and roles validated against database
    
- Access tokens checked for expiration
    
- Roles fetched fresh on each request
    

---
