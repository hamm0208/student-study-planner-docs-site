
# Security Documentation

System: Student Study Planner System

Audience: Developers, Security Auditors, System Administrators

---

## Executive Overview

The Student Study Planner System implements a **MEDIUM-HIGH** security posture with strong foundations in authentication, authorization, and audit logging. This document provides a comprehensive overview of all security implementations, current limitations, and planned improvements.

### Security Coverage Summary

| **Category**         | **Status**      | **Priority** |
| -------------------- | --------------- | ------------ |
| Authentication       | Implemented     | Core         |
| Authorization (RBAC) | Implemented     | Core         |
| Audit Logging        | Implemented     | Core         |
| OWASP Top 10         | Implemented     | High         |
| Rate Limiting        | Implemented     | Medium       |
| Input Validation     | Implemented     | High         |
| Security Headers     | Configured      | High         |
| MFA                  | Not Implemented | Medium       |
| CSRF Protection      | Not Implemented | Medium       |

---
## 3. OWASP Top 10 Coverage

### 3.1 Coverage Matrix

| **OWASP Risk**                      | **Status** | **Implementation**                                   |
| ----------------------------------- | ---------- | ---------------------------------------------------- |
| **A01 - Broken Access Control**     | âœ… DONE     | Server-side auth checks, SuperadminGuard             |
| **A02 - Cryptographic Failures**    | âš ï¸ PARTIAL | 256-bit session secret; secrets exposure issue noted |
| **A03 - Injection**                 | âœ… DONE     | Prisma ORM with parameterized queries                |
| **A04 - Insecure Design**           | âœ… DONE     | Rate limiting implemented                            |
| **A05 - Security Misconfiguration** | âœ… DONE     | Security headers configured                          |
| **A06 - Vulnerable Components**     | âœ… DONE     | Current dependency versions; npm audit recommended   |
| **A07 - Authentication Failures**   | âœ… DONE     | JWT + OAuth; token validation, session refresh       |
| **A09 - Logging & Monitoring**      | âœ… DONE     | Comprehensive audit logging with IP tracking         |
| **A10 - SSRF**                      | âœ… DONE     | No SSRF vulnerabilities identified                   |

### 3.2 SQL Injection Protection

Implementation: Prisma ORM

```directory
src/
â””â”€â”€ utils/
    â””â”€â”€ db/
        â””â”€â”€ db.js
```

**Security Features**:

- Parameterized queries (automatic)

- No raw SQL queries in codebase

- Type-safe database access

- Input validation before ORM queries

**Safe Query Example** (Using Prisma):

```javascript
// âœ… SAFE: Prisma automatically parameterizes queries
const user = await prisma.users.findFirst({
    where: {
        Email: email.toLowerCase().trim() // Input normalized
    }
});

// âœ… SAFE: Prisma prevents injection in dynamic queries
const users = await prisma.users.findMany({
    where: {
        Status: userInput // Parameter is escaped automatically
    }
});

// âŒ NEVER DO THIS: Raw SQL is not used in this project
// const user = await prisma.$queryRaw`SELECT * FROM users WHERE Email = ${email}`;
```
    

### 3.3 XSS Protection

**Mechanisms**:

- React JSX escapes output by default
    
- Content-Type set to text/html with UTF-8
    
- No innerHTML usage for user-controlled data
    
- Frontend validation for user inputs
    

### 3.4 CSRF Protection

**Status**: âš ï¸ NOT YET IMPLEMENTED

**Planned Implementation**: Referenced in [[SECURITY_IMPROVEMENTS.md]]

**Recommendation**: Implement CSRF tokens for state-changing operations

---

## 4. Infrastructure Security

### 4.1 HTTPS & TLS

- Application enforces HTTPS in production (via Vercel/Deployment)
    
- HSTS header configured: `max-age=31536000` (1 year)
    
- All sensitive data transmitted over encrypted channels
    

### 4.2 Security Headers

**Status**: Configured but currently commented out in `next.config.mjs`

**Implemented Headers**:

- `Content-Security-Policy` - Restricts resource loading
    
- `X-Content-Type-Options: nosniff` - Prevents MIME-type sniffing
    
- `X-Frame-Options: DENY` - Prevents clickjacking
    
- `X-XSS-Protection: 1; mode=block` - Browser XSS filter
    
- `Referrer-Policy: strict-origin-when-cross-origin` - Controls referrer info
    
- `Permissions-Policy` - Restricts browser features (geolocation, microphone, camera, payment)
    
- `Strict-Transport-Security (HSTS)` - Forces HTTPS
    

**Reference**: See `next.config.mjs` lines 12-48

### 4.3 CORS Configuration

**Azure AD Endpoints**: Whitelisted in authentication config

**Supabase API**: Restricted to authorized domains

**Database**: PostgreSQL with:

- Connection pooling (Prisma)
    
- Transaction support
    
- Timeout: 30 seconds
    
- Max wait: 10 seconds
    

### 4.4 Environment Variables

**Security**:

- `.env` file contains sensitive data
    
- **âš ï¸ CRITICAL**: Secrets currently stored in plaintext
    
- Should be rotated and moved to secure vault
    

**Variables**:

- `DATABASE_URL` - Supabase connection string
    
- `DIRECT_URL` - Direct database access
    
- `SESSION_SECRET` - JWT signing key (256-bit hex)
    
- `NEXTAUTH_SECRET` - NextAuth secret
    
- `MSAL_CLIENT_ID` - Azure AD client ID
    
- `AUTHORITY_URL` - Azure AD authority
    
- `GMAIL_EMAIL` - Gmail account for notifications
    
- `GMAIL_PASSWORD` - Gmail app password
    

### 4.5 API Rate Limiting

**Request Body Size Limit**: 10MB (configured in `next.config.mjs`)

**Upload Rate Limiting**: See [[#7. Rate Limiting|Rate Limiting]] section

---

## 5. Data Protection

### 5.1 Data at Rest

**Database Encryption**: Supabase handles encryption at rest

**Sensitive Data Handling**:

- No passwords stored in application (OAuth-based)
    
- User emails normalized: `toLowerCase().trim()`
    
- Personal identifiable information (PII) access restricted by role
    

### 5.2 Data in Transit

- HTTPS/TLS for all communications
    
- JWT tokens for API requests
    
- Secure headers configured
    

### 5.3 Role-Based Access Control to Data

**Student Records**:

- Students can only access their own data
    
- Teachers access students in their courses
    
- Admins can access all student records per permissions
    

**Course Data**:

- Cascade delete on role modifications
    
- Proper relational integrity maintained
    

### 5.4 Password Security

**Current Status**: Not applicable (OAuth-based)

**Legacy Field**: `password` field exists in schema but unused

**Recommendation**: Remove legacy password field if OAuth is permanent

---

## 7. Rate Limiting

### 7.1 Upload Rate Limiting

```directory
src/
â””â”€â”€ utils/
    â””â”€â”€ rateLimiting/
        â””â”€â”€ uploadRateLimiter.js
```

**Library**: `rate-limiter-flexible` v8.1.0

**Storage**: In-memory (suitable for single-instance deployments)

### 7.2 Rate Limit Configuration

|**Role**|**Limit**|**Period**|**Cooldown**|
|---|---|---|---|
|**Admin**|50 uploads|1 hour|15 min|
|**Data Manager**|50 uploads|1 hour|15 min|
|**Course Manager**|30 uploads|1 hour|15 min|
|**Regular Users**|20 uploads|1 hour|15 min|
|**Anonymous**|5 uploads|1 hour|15 min|

**Rate Limit Check Example** (`src/utils/rateLimiting/uploadRateLimiter.js`):

```javascript
import { checkRateLimit } from '@utils/rateLimiting/uploadRateLimiter';

// Check rate limit before processing upload
const userIdentifier = user.email || `anonymous_${clientIP}`;
const rateCheckResult = await checkRateLimit(userIdentifier, userRole);

if (rateCheckResult.limited) {
    return NextResponse.json(
        {
            error: 'Too many uploads. Please try again later.',
            retryAfter: rateCheckResult.retryAfter
        },
        { status: 429, headers: { 'Retry-After': rateCheckResult.retryAfter } }
    );
}

// Upload is allowed
console.log(`Upload allowed. Remaining quota: ${rateCheckResult.remaining}`);
await processFileUpload(file);
```

### 7.3 Protected Endpoints

- `/api/course-upload` - Upload course data
    
- `/api/unit-history-upload` - Upload unit history
    
- `/api/term/term-upload` - Upload term data
    
- `/api/unit-upload` - Upload unit data
    

### 7.4 Implementation

**Method**: `checkRateLimit(identifier, role)`

**Returns**:

- `{ limited: false, remaining: N }` - Within limit
    
- `{ limited: true, retryAfter: N }` - Rate limited
    

---

## 8. Input Validation

### 8.1 Email Validation

**Pattern**: `/^[^\s@]+@[^\s@]+\.[^\s@]+$/`

**Normalization and Validation Example**:

```javascript
import { validateEmail } from '@utils/auth/emailUtils';

// Normalize and validate email
const normalizedEmail = email.toLowerCase().trim();
const isValid = validateEmail(normalizedEmail);

if (!isValid) {
    throw new Error('Invalid email format');
}

// Email is UNIQUE in database
const existingUser = await prisma.users.findFirst({
    where: { Email: normalizedEmail }
});

if (existingUser) {
    throw new Error('Email already registered');
}
```

**Database Constraint**: UNIQUE email address

### 8.2 User Management Validation

**Required Fields**:

- Email (non-empty, valid format)
    
- First Name (non-empty)
    
- Last Name (non-empty)
    
- Status (published, unpublished, draft, unavailable)
    

### 8.3 CSV Upload Validation

**Course CSV Fields**:

- Course Code: Required, non-empty
    
- Course Name: Required, non-empty
    
- Credits: Numeric, positive
    
- Status: Enum validation
    

**Unit CSV Fields**:

- Unit Code: Required, non-empty
    
- Unit Name: Required, non-empty
    
- Credits: Numeric, positive
    

### 8.4 File Upload Validation

**Size Limits**:

- Maximum request body: 10MB
    
- Per-file limits enforced at API level
    

**Type Validation**:

- CSV uploads validated for structure
    
- Content-Type header checked
    

---

## 9. Session Management

### 9.1 Storage Strategy

**Secure Storage Example**:

```javascript
// âœ… SECURE: Use sessionStorage for session tokens
sessionStorage.setItem('sessionToken', token);
sessionStorage.setItem('userEmail', email);
sessionStorage.setItem('userRoles', JSON.stringify(roles));

// âœ… SECURE: Retrieve with server-side validation
const storedEmail = sessionStorage.getItem('userEmail');
const storedRoles = JSON.parse(sessionStorage.getItem('userRoles') || '[]');

// âš ï¸ IMPORTANT: Always validate against database on server side
const freshUserData = await SecureSessionManager.authenticateUser(request);
// Never trust client-sent data for authorization

// âŒ NEVER USE: localStorage for sensitive data
// localStorage.setItem('sessionToken', token); // INSECURE
// localStorage.setItem('password', password); // CRITICAL: NEVER DO THIS
```

**Benefits of sessionStorage**:

- Not accessible to same-site cookies
    
- Cleared on browser tab close
    
- Not persisted across sessions
    
- Not vulnerable to cookie theft
    

### 9.2 Session Expiration

**Token Expiration**: 24 hours

**Implementation**:

- JWT `exp` claim set at creation
    
- Verified on every request
    
- Expired session triggers re-login prompt
    

### 9.3 Session Refresh

**Endpoint**: `/api/auth/session-refresh`

**Purpose**:

- Extend session timeout
    
- Check for role updates
    
- Validate user still active
    

**Flow**:

```
1. Frontend calls refresh endpoint
2. Server validates current session
3. Server checks user activation status
4. Server creates new token
5. Frontend updates sessionStorage
```

### 9.4 Session Invalidation

**Logout Process**:

JavaScript

```
sessionStorage.removeItem('sessionToken')
sessionStorage.removeItem('userEmail')
sessionStorage.removeItem('userRoles')
// Frontend redirects to login
```

---

## 10. Development & Testing Overrides

### 10.1 Development Mode

```directory
src/
â””â”€â”€ utils/
    â””â”€â”€ auth/
        â””â”€â”€ DevOverride.js
```

**Activation Conditions**:

- `NODE_ENV === 'development'` AND
    
- `NEXT_PUBLIC_MODE === 'DEV'`
    

**Features** (Development Only):

- Bypass authentication checks
    
- Grant all permissions
    
- Superadmin role access
    
- Console warning when enabled
    

**Safety**:

- âŒ Cannot activate in production
    
- Console error if attempted in production
    
- Explicit checks prevent accidental exposure
    

### 10.2 Test User Management

```directory
scripts/
â””â”€â”€ create-test-users.js
```

**Purpose**: Create test users with different roles for development

**Available Test Users**:

- Admin users
    
- Course coordinators
    
- Students
    
- Viewers
    

---

## 11. Security Testing & Scanning Tools

### 11.1 Current Testing Status

**Automated Testing**: Not yet implemented

**Manual Testing**: Available via browser DevTools

**Related Documentation**: [[SECURITY_IMPROVEMENTS.md]]

### 11.2 Snyk - Dependency Vulnerability Scanning

**Status**: âŒ NOT IMPLEMENTED

**Purpose**: Automated vulnerability detection in project dependencies

**Benefits**:

- Real-time vulnerability alerts
    
- Dependency update recommendations
    
- CI/CD integration
    
- Security advisory notifications
    

**Setup Recommendations**:

1. **Install Snyk CLI**:
    

Bash

```
npm install -g snyk
```

2. **Authenticate**:
    

Bash

```
snyk auth
```

3. **Test Dependencies**:
    

Bash

```
snyk test
```

4. **Monitor Project**:
    

Bash

```
snyk monitor
```

5. **CI/CD Integration** (GitHub Actions):
    

YAML

```
- name: Run Snyk scan
  uses: snyk/actions/node@master
  env:
    SNYK_TOKEN: ${{ secrets.SNYK_TOKEN }}
```

**Configuration File** (`.snyk`):

YAML

```
version: v1.0.0
ignore:
  SNYK-JS-LODASH-1018905:
    - '*':
      reason: 'Accepted risk'
      expires: '2025-12-31'
```

### 11.3 OWASP ZAP - Dynamic Application Security Testing

**Status**: âŒ NOT IMPLEMENTED

**Purpose**: Automated security scanning of running application

**Benefits**:

- Identifies XSS, injection, and other runtime vulnerabilities
    
- API endpoint security testing
    
- Automated spider/crawler testing
    
- HTML report generation
    

**Integration Approaches**:

**Option 1: Docker Container**:

Bash

```
docker run -t owasp/zap2docker-stable zap-baseline.py \
  -t http://localhost:3000 \
  -r report.html
```

**Option 2: GitHub Actions**:

YAML

```
- name: Run ZAP scan
  uses: zaproxy/action-baseline@v0.4.0
  with:
    target: 'http://localhost:3000'
    rules_file_name: '.zap/rules.tsv'
    cmd_options: '-a'
```

**GitHub Actions Workflow**:

YAML

```
name: OWASP ZAP Scan
on: [push, pull_request]
jobs:
  zap:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - name: Run ZAP scan
        uses: zaproxy/action-baseline@v0.4.0
        with:
          target: 'http://localhost:3000'
          rules_file_name: '.zap/rules.tsv'
```

**Configuration**:

```directory
.zap/
â””â”€â”€ rules.tsv
```

```
id	priority	action
10010	medium	PASS
10015	high	FAIL
10020	medium	IGNORE
```

### 11.4 Postman - API Security Testing

**Status**: âŒ NOT IMPLEMENTED

**Purpose**: Manual and automated API endpoint testing

**Benefits**:

- Test all API endpoints systematically
    
- Validate authentication/authorization
    
- Test rate limiting and error handling
    
- Generate API documentation
    
- CI/CD integration testing
    

**Setup Recommendations**:

1. **Create Test Collection**:
    
    - Auth endpoints (login, session refresh)
        
    - User management (create, read, update, delete)
        
    - Role management
        
    - Audit logs
        
    - File uploads
        
2. **Create Environment Variables** in the following structure:

```directory
postman/
â”œâ”€â”€ collection.json
â””â”€â”€ environment.json
```

Environment Variables Example:

```json
{
  "baseUrl": "http://localhost:3000",
  "sessionToken": "{{auth_token}}",
  "userEmail": "admin@example.com"
}
```

3. **Test Scripts Example**:
    

JavaScript

```
// Validate authentication required
pm.test("Status code should be 401 if unauthorized", function() {
    pm.response.to.have.status(401);
});

// Validate response structure
pm.test("Response should have session token", function() {
    pm.expect(pm.response.json()).to.have.property('sessionToken');
});
```

4. **CI/CD Integration** (GitHub Actions):


YAML

```yaml
- name: Run Postman tests
  uses: matt-ball/newman-action@master
  with:
    collection: ./postman/collection.json
    environment: ./postman/environment.json
    reporters: cli,json
```

**File Structure**:

```directory
postman/
â”œâ”€â”€ collection.json
â””â”€â”€ environment.json
```

5. **Newman Command Line**:


Bash

```bash
newman run collection.json \
  -e environment.json \
  --reporters json,html \
  --reporter-json-export results.json
```

### 11.5 Browser DevTools - Security Testing

**Status**: âœ… AVAILABLE (No configuration needed)

**Manual Testing Areas**:

**Console**:

- Check for console errors
    
- Verify no sensitive data logged
    
- Monitor network requests
    

**Network Tab**:

- Verify HTTPS connections
    
- Check security headers
    
- Monitor token transmission
    
- Validate CORS headers
    

**Application/Storage**:

- Verify sessionStorage usage (not localStorage)
    
- Check cookie security flags (HttpOnly, Secure, SameSite)
    
- Monitor session token storage
    

**Example DevTools Checks**:

JavaScript

```
// Check if token is in sessionStorage (good)
console.log(sessionStorage.getItem('sessionToken'))

// Verify no sensitive data in localStorage
Object.keys(localStorage).forEach(key => {
  if (key.includes('token') || key.includes('secret')) {
    console.warn('Sensitive data in localStorage:', key)
  }
})
```

---

## 12. Dependencies & Security-Related Packages

### 12.1 Authentication & Authorization

|**Package**|**Version**|**Purpose**|
|---|---|---|
|`jsonwebtoken`|^9.0.2|JWT signing and verification|
|`@azure/msal-browser`|^4.12.0|OAuth authentication|
|`@azure/msal-react`|^3.0.12|React OAuth integration|

### 12.2 Rate Limiting & Security

|**Package**|**Version**|**Purpose**|
|---|---|---|
|`rate-limiter-flexible`|^8.1.0|Rate limiting implementation|
|`next`|^15.5.6|Built-in security features|

### 12.3 Database & ORM

|**Package**|**Version**|**Purpose**|
|---|---|---|
|`@prisma/client`|^6.5.0|ORM with parameterized queries|

### 12.4 Communication & Notifications

|**Package**|**Version**|**Purpose**|
|---|---|---|
|`nodemailer`|^7.0.5|Email sending for notifications|

### 12.5 Frontend Security

|**Package**|**Version**|**Purpose**|
|---|---|---|
|`react`|^18.3.1|XSS prevention via JSX|
|`react-dom`|^18.3.1|React rendering|

### 12.6 Recommendations

**Regular Maintenance**:

- Run `npm audit` monthly
    
- Update security-related packages
    
- Monitor security advisories
    
- Test updates in staging before production
    

**Planned Tools**:

- Add `snyk` for continuous vulnerability scanning
    
- Add `jest` or `vitest` for unit testing
    
- Add `playwright` for end-to-end testing
    

---

## 13. Known Issues & Improvement Roadmap

### 13.1 Critical Issues

**1. Exposed Secrets in .env** (Status: ğŸ”„ NOTED)

**Impact**: High - Database credentials and API keys exposed

**Current State**:

```
DATABASE_URL=[plaintext connection string]
SESSION_SECRET=[plaintext 256-bit hex]
GMAIL_PASSWORD=[plaintext app password]
```

**Recommendations**:

- [ ] Rotate all exposed credentials immediately
    
- [ ] Move secrets to secure vault (AWS Secrets Manager, Azure Key Vault, etc.)
    
- [ ] Use environment variable encryption
    
- [ ] Implement secret rotation policy
    
- [ ] Add secrets scanning to CI/CD (e.g., git-secrets, TruffleHog)


### 13.2 High Priority Issues

**1. Security Headers** (Status: âš ï¸ Configured but Inactive)

**Issue**: Headers are defined in `next.config.mjs` but commented out

**Impact**: Medium - Missing browser security protections

**Solution**: Uncomment headers in `next.config.mjs`

**2. MSAL Token Storage** (Status: âš ï¸ Partial Risk)

**Issue**: Azure AD tokens stored in localStorage (XSS vulnerable)

**Current Mitigation**: Session tokens use sessionStorage

**Recommendation**: Evaluate cookie-based storage or token refresh endpoint

**3. MFA (Multi-Factor Authentication)** (Status: âŒ Not Implemented)

**Impact**: High - Admin accounts vulnerable to credential compromise

**Planned**: TOTP-based MFA for admin users


### 13.3 Medium Priority Issues

**1. CSRF Protection** (Status: âŒ Not Implemented)

**Impact**: Medium - State-changing requests vulnerable

**Solution**: Implement CSRF tokens for all state-changing operations

**2. Business Logic Validation** (Status: âš ï¸ Partial)

**Issue**: Some authorization checks are placeholder implementations

**Examples**:

- `/api/roles` has `checkAuthorization()` that always returns `true`
    

**Solution**: Complete authorization implementation for all endpoints

**3. Real-Time Security Alerts** (Status: âŒ Not Implemented)

**Benefit**: Immediate notification of suspicious activities

**Planned Events**:

- Failed login attempts
    
- Permission elevation
    
- Unusual access patterns
    

### 13.4 Improvement Status Checklist

**Completed (âœ… DONE)**:

- [x] Exposed secrets removal (planned)
    
- [x] Security headers configuration
    
- [x'x] Token storage mitigation (sessionStorage)
    
- [x] IP and User Agent logging
    
- [x] Audit trail implementation
    
- [x] RBAC system design
    
- [x] Rate limiting
    

**In Progress (ğŸ”„)**:

- [ ] Rotate exposed credentials
    
- [ ] TOTP MFA for admin accounts


**Pending (â³)**:

- [ ] CSRF protection implementation
    
- [ ] Business logic validation completion
    
- [ ] Real-time alerting system

**Scheduled Maintenance**:

- Run `npm audit` - Monthly
    
- Review audit logs - Quarterly
    
- Security audit - Annually
    
- Penetration testing - Annually
    

**Reference**: [[SECURITY_IMPROVEMENTS.md]]

---

## 14. File Structure & Implementation Reference

### 14.1 Core Security Files

```directory
src/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ authConfig.js (Azure AD OAuth configuration)
â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â””â”€â”€ auth/
â”‚   â”‚       â””â”€â”€ user-login/
â”‚   â”‚           â””â”€â”€ route.js (Login endpoint implementation)
â”‚   â””â”€â”€ class/
â”‚       â”œâ”€â”€ Role/
â”‚       â”‚   â”œâ”€â”€ SuperadminGuard.js (Superadmin protection)
â”‚       â”‚   â””â”€â”€ RoleDB.js (Role database operations)
â”‚       â””â”€â”€ Audit/
â”‚           â””â”€â”€ AuditLogger.js (Audit logging implementation)
â””â”€â”€ utils/
    â”œâ”€â”€ auth/
    â”‚   â”œâ”€â”€ SimpleSessionManager.js (JWT session management)
    â”‚   â”œâ”€â”€ FrontendAuthHelper.js (Frontend authentication utilities)
    â”‚   â””â”€â”€ DevOverride.js (Development mode overrides)
    â”œâ”€â”€ permissions.js (RBAC permission checking)
    â”œâ”€â”€ rateLimiting/
    â”‚   â””â”€â”€ uploadRateLimiter.js (Upload rate limiting)
    â””â”€â”€ db/
        â””â”€â”€ db.js (Database ORM initialization)
```

### 14.2 API Route Files

```directory
src/
â””â”€â”€ app/
    â””â”€â”€ api/
        â”œâ”€â”€ auth/
        â”‚   â””â”€â”€ user-login/
        â”‚       â””â”€â”€ route.js (User authentication)
        â”œâ”€â”€ users/
        â”‚   â””â”€â”€ route.js (User management)
        â”œâ”€â”€ roles/
        â”‚   â””â”€â”€ route.js (Role management)
        â”œâ”€â”€ audit_logs/
        â”‚   â””â”€â”€ route.js (Audit log retrieval)
        â”œâ”€â”€ course-upload/
        â”‚   â””â”€â”€ route.js (CSV upload - rate-limited)
        â”œâ”€â”€ unit-upload/
        â”‚   â””â”€â”€ route.js (CSV upload - rate-limited)
        â””â”€â”€ term/
            â””â”€â”€ term-upload/
                â””â”€â”€ route.js (CSV upload - rate-limited)
```

**API Endpoints**:
- `/api/auth/user-login` - User authentication
- `/api/users` - User management
- `/api/roles` - Role management
- `/api/audit_logs` - Audit log retrieval
- `/api/course-upload` - CSV upload (rate-limited)
- `/api/unit-upload` - CSV upload (rate-limited)
- `/api/term/term-upload` - CSV upload (rate-limited)

### 14.3 Configuration Files

```directory
project-root/
â”œâ”€â”€ .env (Environment variables - âš ï¸ Contains secrets)
â”œâ”€â”€ next.config.mjs (Next.js configuration - security headers)
â”œâ”€â”€ package.json (Dependencies and scripts)
â””â”€â”€ prisma/
    â””â”€â”€ schema.prisma (Database schema with RBAC models)
```

### 14.4 Database Schema Files

**RBAC Models**:

- `User` - User accounts
    
- `UserProfile` - User profile information
    
- `UserRole` - Role assignments to users
    
- `Role` - Role definitions
    
- `Permission` - Permission definitions
    
- `RolePermission` - Role-to-permission mappings
    

**Audit Models**:

- `AuditLog` - Security event logging
    

---

## 15. Compliance & Standards

### 15.1 Standards Addressed

- **OWASP Top 10** (7/10 fully covered)
    
- **NIST Cybersecurity Framework** (partial alignment)
    
- **Basic GDPR Considerations** (User data access control)
    

### 15.2 Data Retention

**Audit Logs**: Recommended 6-12 months retention

**Session Data**: Cleared on logout/session expiration

**Personal Data**: Subject to deletion policies per regulations

---
